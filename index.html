<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tesoura — Controle do Futebol</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b1220" />

  <style>
    :root{
      --bg:#07101f;
      --panel:#0b1a33;
      --panel2:#0a1730;
      --line:rgba(255,255,255,.10);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.70);
      --orange:#ff8b2a;
      --green:#16d07f;
      --blue:#4b86ff;
      --red:#ff3b3b;
      --shadow: 0 14px 40px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 50% 0%, rgba(255,139,42,.10), transparent 60%),
                  radial-gradient(900px 500px at 10% 30%, rgba(75,134,255,.12), transparent 60%),
                  radial-gradient(900px 500px at 90% 30%, rgba(22,208,127,.10), transparent 60%),
                  linear-gradient(180deg, #050a14, var(--bg));
      color:var(--text);
      overflow-x:hidden;
    }

    .topbar{
      width:100%;
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:240px;
    }
    .brand .logo{
      width:34px;height:34px;border-radius:10px;
      display:grid;place-items:center;
      background:rgba(255,139,42,.18);
      border:1px solid rgba(255,139,42,.35);
      font-weight:900;
    }
    .brand .txt{
      display:flex;flex-direction:column;line-height:1.1;
    }
    .brand .txt .t{font-weight:900}
    .brand .txt .s{font-size:12px;color:var(--muted)}

    .right{
      display:flex;align-items:center;gap:10px;flex-wrap:wrap;justify-content:flex-end;
    }
    .badge{
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.22);
      font-size:12px;font-weight:800;
      color:var(--orange);
      white-space:nowrap;
    }
    .btn{
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.25);
      color:var(--text);
      padding:8px 12px;
      border-radius:12px;
      font-weight:900;
      cursor:pointer;
      white-space:nowrap;
    }
    .btn:hover{filter:brightness(1.05)}
    .btn.secondary{background:rgba(255,139,42,.16); border-color:rgba(255,139,42,.35)}
    .btn.logout{background:rgba(255,255,255,.08)}
    .wrap{
      width:100%;
      max-width:1600px;
      margin:0 auto;
      padding:0 16px 22px;
    }

    .tabs{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      padding:12px;
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.22);
      box-shadow: var(--shadow);
    }
    .tab-btn{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.18);
      color:var(--text);
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .tab-btn.active{
      background:rgba(255,139,42,.18);
      border-color:rgba(255,139,42,.35);
      color:var(--orange);
    }

    .panelArea{
      margin-top:14px;
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.20);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .panelFrame{
      width:100%;
      height: calc(100vh - 220px);
      border:0;
      display:block;
      background:transparent;
    }

    @media (max-width: 820px){
      .panelFrame{height: calc(100vh - 280px);}
      .brand{min-width:auto}
      .tab-btn{padding:9px 10px; font-size:13px}
    }

    /* ====== TELA INICIAL (LOGIN) ====== */
    #telaInicial{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      background:rgba(0,0,0,.55);
      backdrop-filter: blur(6px);
      z-index: 9999;
    }
    #telaInicial .box{
      width:min(820px, 100%);
      border-radius:22px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(11,26,51,.92), rgba(7,16,31,.92));
      box-shadow: var(--shadow);
      padding:18px;
    }
    #telaInicial .title{
      font-weight:1000;
      font-size:22px;
      color:var(--orange);
      letter-spacing:.3px;
      margin-bottom:6px;
      text-align:center;
    }
    #telaInicial .sub{
      text-align:center;
      color:var(--text);
      font-weight:800;
      margin:4px 0;
    }
    #telaInicial .row{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px;
      margin-top:16px;
    }
    #telaInicial .b{
      width:100%;
      border-radius:14px;
      border:0;
      padding:12px 14px;
      font-weight:1000;
      cursor:pointer;
    }
    #telaInicial .green{background:var(--green); color:#00120a}
    #telaInicial .blue{background:var(--blue); color:#08122a}
    #telaInicial .msg{
      margin-top:10px;
      text-align:center;
      color:rgba(255,255,255,.85);
      font-weight:900;
      min-height:18px;
    }

#telaInicial .inp{width:100%;box-sizing:border-box;border:1px solid rgba(255,255,255,.16);background:rgba(0,0,0,.25);color:#eaf0ff;border-radius:12px;padding:10px 12px;font-weight:800;outline:none}
#telaInicial .inp:focus{border-color:rgba(255,255,255,.35)}
@media (max-width: 820px){
  #telaInicial .row{grid-template-columns:1fr !important;}
}

  </style>
</head>
<body>

  <div class="topbar">
    <div class="brand">
      <div class="logo">T</div>
      <div class="txt">
        <div class="t">Tesoura — Controle do Futebol</div>
        <div class="s">Acesso da Diretoria (edita).</div>
      </div>
    </div>
    <div class="right">
      <div class="badge" id="modeBadge">Modo: —</div>
      <button class="btn secondary" id="btnLogin">ENTRAR (DIRETORIA)</button>
      <button class="btn logout" id="btnLogout">SAIR</button>
    </div>
  </div>

  <div class="wrap">
    <div class="tabs">
      <button class="tab-btn active" id="aba-jogadores" onclick="abrirAba('aba-jogadores')">JOGADORES</button>
      <button class="tab-btn" id="aba-presenca" onclick="abrirAba('aba-presenca')">PRESENÇA / ESCALAÇÃO</button>
      <button class="tab-btn" id="aba-controle" onclick="abrirAba('aba-controle')">CONTROLE GERAL</button>
      <button class="tab-btn" id="aba-mensalidade" onclick="abrirAba('aba-mensalidade')">MENSALIDADE</button>
      <button class="tab-btn" id="aba-caixa" onclick="abrirAba('aba-caixa')">CAIXA</button>
      <button class="tab-btn" id="aba-gols" onclick="abrirAba('aba-gols')">GOLS</button>
      <button class="tab-btn" id="aba-banco" onclick="abrirAba('aba-banco')">BANCO DE DADOS</button>
    </div>

    <div class="panelArea">
      <iframe class="panelFrame" id="frame-jogadores" data-src="tesoura_jogadores_teste.html"></iframe>
      <iframe class="panelFrame" id="frame-presenca" data-src="tesoura_presenca_escala_R5.html" style="display:none"></iframe>
      <iframe class="panelFrame" id="frame-controle" data-src="tesoura_controle_geral_teste.html" style="display:none"></iframe>
      <iframe class="panelFrame" id="frame-mensalidade" data-src="tesoura_mensalidade_R4.html" style="display:none"></iframe>
      <iframe class="panelFrame" id="frame-caixa" data-src="tesoura_caixa_teste.html" style="display:none"></iframe>
      <iframe class="panelFrame" id="frame-gols" data-src="tesoura_gols_teste.html" style="display:none"></iframe>
      <iframe class="panelFrame" id="frame-banco" data-src="tesoura_banco_dados_teste.html" style="display:none"></iframe>
    </div>
  </div>

  <div id="telaInicial">
    <div class="box">
      <div class="title">GRUPO TESOURA !</div>
      <div class="sub">ESPORTE, FAMÍLIA E AMIZADE</div>
      <div class="sub">Digite a senha (visível) e escolha o acesso</div>

      <div class="row">
        <div>
          <div style="font-weight:1000; margin-bottom:6px;">JOGADORES (VISUAL)</div>
          <input id="senhaJogador" class="inp" type="text" placeholder="TESOURA2026" autocomplete="off" />
          <button class="b green" style="margin-top:10px;" onclick="TESOURA_ENTRAR_JOGADORES()">ENTRAR JOGADORES</button>
        </div>

        <div>
          <div style="font-weight:1000; margin-bottom:6px;">DIRETORIA (EDITA)</div>
          <input id="senhaDiretor" class="inp" type="text" placeholder="1baidec / 2thiago / 3love / 4le / 5titi" autocomplete="off" />
          <button class="b blue" style="margin-top:10px;" onclick="TESOURA_ENTRAR_DIRETORIA()">ENTRAR DIRETORIA</button>

          <div class="msg" id="telaMsg"></div>
        </div>
      </div>

      <div class="msg" style="opacity:.9;">
        Regra: Jogador só visualiza (não edita). Diretor edita. Diretores 3love/4le/5titi: sem CAIXA.
      </div>
    </div>
  </div>

  <script src="app/js/config.js"></script>
  <script>
    // helpers
    const qs = (id)=>document.getElementById(id);

    let modoJogador = false;

    function setBadge(txt){
      const el = qs("modeBadge");
      if(el) el.textContent = "Modo: " + (txt || "—");
    }

    function showTelaInicial(show){
      const el = qs("telaInicial");
      if(el) el.style.display = show ? "flex" : "none";
    }

    function TESOURA_setMsg(txt){
      const el = qs("telaMsg");
      if(el) el.textContent = txt || "";
    }

    function TESOURA_setPermissaoCaixa(visivel){
      const btn = qs("aba-caixa");
      if(btn) btn.style.display = visivel ? "" : "none";

      const caixaEl = qs("aba-caixa");
      if(!visivel && caixaEl && caixaEl.classList.contains("active")){
        abrirAba("aba-jogadores");
      }
    }

    function TESOURA_precarregarIframes(){
      const ifs = Array.from(document.querySelectorAll("iframe[data-src]"));
      for(const f of ifs){
        if(!f.getAttribute("src")){
          f.setAttribute("src", f.getAttribute("data-src"));
        }
      }
    }

    function ensureIframeLoaded(tabId){
      const map = {
        "aba-jogadores": "frame-jogadores",
        "aba-presenca": "frame-presenca",
        "aba-controle": "frame-controle",
        "aba-mensalidade": "frame-mensalidade",
        "aba-caixa": "frame-caixa",
        "aba-gols": "frame-gols",
        "aba-banco": "frame-banco",
      };
      const frameId = map[tabId];
      const iframe = frameId ? qs(frameId) : null;
      if(iframe && !iframe.getAttribute("src")){
        iframe.setAttribute("src", iframe.getAttribute("data-src"));
      }
    }

    function abrirAba(tabId){
      const tabs = Array.from(document.querySelectorAll(".tabs .tab-btn"));
      tabs.forEach(b=>b.classList.toggle("active", b.id === tabId));

      const frames = Array.from(document.querySelectorAll(".panelArea iframe"));
      frames.forEach(f=>f.style.display = "none");

      ensureIframeLoaded(tabId);

      const map = {
        "aba-jogadores": "frame-jogadores",
        "aba-presenca": "frame-presenca",
        "aba-controle": "frame-controle",
        "aba-mensalidade": "frame-mensalidade",
        "aba-caixa": "frame-caixa",
        "aba-gols": "frame-gols",
        "aba-banco": "frame-banco",
      };
      const frameId = map[tabId];
      const iframe = frameId ? qs(frameId) : null;
      if(iframe) iframe.style.display = "block";

      // aplica trava quando trocar
      setTimeout(()=>TESOURA_TRAVAR_IFRAMES(modoJogador), 300);
    }

    function TESOURA_TRAVAR_IFRAMES(travar){
      const iframes = Array.from(document.querySelectorAll(".panelArea iframe"));
      for(const iframe of iframes){
        try{
          const doc = iframe.contentDocument || iframe.contentWindow?.document;
          if(!doc) continue;
          let style = doc.getElementById("TESOURA_JOGADOR_LOCK");
          if(travar){
            if(!style){
              style = doc.createElement("style");
              style.id = "TESOURA_JOGADOR_LOCK";
              style.textContent = `
                a, button, input, select, textarea, [role="button"], [onclick]{
                  pointer-events:none !important;
                  cursor: default !important;
                }
                input, select, textarea{ user-select:text !important; }
              `;
              doc.head.appendChild(style);
            }
          }else{
            if(style) style.remove();
          }
        }catch(e){}
      }
    }

    // ===== LOGIN (SENHAS) =====
    const SENHA_JOGADOR = "TESOURA2026";
    const SENHAS_DIRETORES = {
      "1baidec": { caixa: true,  label: "DIRETOR (COM CAIXA)" },
      "2thiago": { caixa: true,  label: "DIRETOR (COM CAIXA)" },
      "3love":   { caixa: false, label: "DIRETOR (SEM CAIXA)" },
      "4le":     { caixa: false, label: "DIRETOR (SEM CAIXA)" },
      "5titi":   { caixa: false, label: "DIRETOR (SEM CAIXA)" },
    };

    function TESOURA_ENTRAR_JOGADORES(){
      const pw = (qs("senhaJogador")?.value || "").trim();
      if(pw !== SENHA_JOGADOR){
        TESOURA_setMsg("Senha de JOGADOR inválida.");
        return;
      }
      modoJogador = true;
      setBadge("JOGADOR (VISUAL)");
      showTelaInicial(false);
      TESOURA_setPermissaoCaixa(true);
      TESOURA_precarregarIframes();
      abrirAba("aba-jogadores");
      TESOURA_TRAVAR_IFRAMES(true);
      TESOURA_setMsg("");
    }

    function TESOURA_ENTRAR_DIRETORIA(){
      const pw = (qs("senhaDiretor")?.value || "").trim();
      const perm = SENHAS_DIRETORES[pw];
      if(!perm){
        TESOURA_setMsg("Senha de DIRETORIA inválida.");
        return;
      }
      modoJogador = false;
      setBadge(perm.label);
      showTelaInicial(false);
      TESOURA_setPermissaoCaixa(!!perm.caixa);
      TESOURA_precarregarIframes();
      abrirAba("aba-jogadores");
      TESOURA_TRAVAR_IFRAMES(false);
      TESOURA_setMsg("");
    }

    window.addEventListener("load", ()=>{
      // sempre pede login ao abrir
      showTelaInicial(true);
      setBadge("—");
      abrirAba("aba-jogadores");

      // Botões do topo
      const btnL = qs("btnLogin");
      const btnS = qs("btnLogout");
      if(btnL){
        btnL.textContent = "ENTRAR / TROCAR";
        btnL.onclick = () => {
          const sj = qs("senhaJogador"); if(sj) sj.value = "";
          const sd = qs("senhaDiretor"); if(sd) sd.value = "";
          TESOURA_setMsg("");
          showTelaInicial(true);
          setBadge("—");
          TESOURA_TRAVAR_IFRAMES(false);
          TESOURA_setPermissaoCaixa(true);
        };
      }
      if(btnS){
        btnS.onclick = () => {
          const sj = qs("senhaJogador"); if(sj) sj.value = "";
          const sd = qs("senhaDiretor"); if(sd) sd.value = "";
          TESOURA_setMsg("");
          showTelaInicial(true);
          setBadge("—");
          TESOURA_TRAVAR_IFRAMES(false);
          TESOURA_setPermissaoCaixa(true);
          abrirAba("aba-jogadores");
        };
      }
    });

  </script>
</body>
</html>
